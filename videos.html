<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Videos</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 font-mono">

    <!-- HEADER -->
    <header class="bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 text-white shadow-md">
        <div class="max-w-7xl mx-auto px-4 py-6 flex flex-col md:flex-row justify-between items-center">
            <!-- Left: Logo / Title -->
            <div class="flex items-center space-x-4">LOCK-IN</div>

            <!-- Right: Navigation -->
            <nav class="mt-4 md:mt-0 space-x-6 text-lg font-medium">
                <a href="/index.html" class="hover:text-yellow-300 transition">ðŸ“¹ Home</a>
                <a href="#about" class="hover:text-yellow-300 transition">ðŸ§  About Me</a>
            </nav>
        </div>
    </header>

    <!-- Video Page Layout -->
    <section class="max-w-7xl mx-auto px-6 py-12 flex flex-col md:flex-row">
        <!-- Sidebar (Left) -->
        <div class="w-full md:w-1/4 bg-white shadow-md rounded-lg p-6 mb-8 md:mb-0 md:mr-8">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">Topics</h3>
            <ul class="space-y-4">
                <li><a href="#" class="text-lg text-gray-800 hover:text-purple-500 transition" onclick="loadVideo('perturbation_1')">Perturbation Theory: Theorem 1</a></li>
            </ul>
        </div>

        <!-- Video Player (Right) -->
        <div class="flex-1 bg-white shadow-md rounded-lg p-6">
            <h2 id="videoTitle" class="text-3xl font-semibold text-gray-800 mb-4">Select A Video</h2>

            <!-- Video Player -->
            <div id="videoZone" class="aspect-w-16 aspect-h-9 mb-6" style="display: none;">
                <video id="videoPlayer" class="w-full h-full rounded-lg" controls muted>
                    <source id="videoSource" src="static/videos/perturbation_theorem_1.mp4">
                    Your browser does not support the video tag.
                </video>

                <div class="timestamp mt-5">
                    <button class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700" onclick="getTimestamp()">Get Timestamp</button>
                </div>
            </div>

            <!-- Notes -->
            <div id="noteSection" class="mt-10">
                <h3 class="text-xl font-semibold text-gray-800 mb-2">Take Notes or Jot Down Questions</h3>
                <textarea id="notes" class="w-full h-32 p-4 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-indigo-500 resize-none overflow-y-auto" placeholder="Write down notes or questions here"></textarea>
            </div>

            <div class="save mt-3">
                <button class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700" onclick="saveNotes()">Save Notes</button>
            </div>
        </div>
    </section>

    <script>
        const videoData = {
            "perturbation_1": {title: "Perturbation Theory: Theorem 1",}
        };

        function loadVideo(videoCode) {
            const video = videoData[videoCode];
            if (video) {
                // Update the title
                document.getElementById('videoTitle').textContent = video.title;

                // Display the video screen
                document.getElementById("videoZone").style.display = "block";

                // Get the video element and update the source
                const videoPlayer = document.getElementById('videoPlayer');
                const videoSource = document.getElementById('videoSource');
                
                // Set the new video source dynamically
                videoSource.src = `static/videos/${videoCode}.mp4`;

                // Reload and play the video
                videoPlayer.load();  // reload the video with the new source
                videoPlayer.play().then(function() {
                    console.log("Video started playing");
                }).catch(function(error) {
                    console.error("Failed to play video:", error);
                });
            } else {
                alert("Video not found!");
            }
        }

        // Function to get timestamp to the textarea
        function getTimestamp() {
            const videoPlayer = document.getElementById('videoPlayer');
            const timestamp = videoPlayer.currentTime;
            
            // Format the timestamp as mm:ss
            const minutes = Math.floor(timestamp / 60);
            const seconds = Math.floor(timestamp % 60);
            const formattedTimestamp = `${minutes}:${seconds < 10 ? '0' + seconds : seconds}`;

            // Get the current cursor position in the textarea
            const notes = document.getElementById('notes');
            const cursorPos = notes.selectionStart;

            // Insert the timestamp at the cursor position
            const textBefore = notes.value.substring(0, cursorPos);
            const textAfter = notes.value.substring(cursorPos);

            // Update the textarea with the timestamp at the cursor
            notes.value = textBefore + `[${formattedTimestamp}] ` + textAfter;

            // Move the cursor position after the inserted timestamp
            notes.selectionStart = notes.selectionEnd = cursorPos + formattedTimestamp.length + 4;
            notes.focus();
        }

        function saveNotes() {
            const notes = document.getElementById('notes');
            const text = notes.value;

            // Create blob with notes text
            const blob = new Blob([text], {type: 'text/plain'});
            const link = document.createElement('a');

            // Create URL
            link.download = 'notes.txt';
            link.href = URL.createObjectURL(blob);

            // Trigger download
            link.click();
        }

        // Play video on click
        document.getElementById('video_cta').addEventListener('click', function() {
            let video = document.getElementById('videoPlayer');
            video.play().then(function() {
                console.log("Video is playing");
            }).catch(function(error) {
                console.log("Error playing video:", error);
            });
        });
    </script>
</body>
</html>
